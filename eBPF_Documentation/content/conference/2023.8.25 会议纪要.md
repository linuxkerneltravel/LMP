[TOC]



## 网络枢纽监控工具——赵宸阳

### 内容概述:

#### 工具主要功能与设计理念:

- 赵宸阳设计这款工具的目标是更有效地监控网络连接，同时为IT团队提供重要的网络信息。
- 其核心功能是收集和展示网络连接的基础信息，例如：连接的pid、command、四元组以及连接方向。
- 该工具的设计初衷旨在弥补当前市场上同类产品的不足，提供更准确、快捷且高效的监控手段。

#### 数据包信息深入分析:

- 除基本信息收集外，此工具还能进行深度分析，详解数据包的内部结构。
- 它会展示诸如已确认的字节数、可接收的字节数、接收和发送窗口的大小、慢启动过程及发送缓存大小等关键数据。
- 这种专业的分析功能助于网络管理员迅速定位并解决问题，进而提升整体网络性能。

#### 用户界面与个性化设置:

- 该工具拥有简洁且直观的用户界面，让初次使用者也能轻松上手。
- 考虑到高级用户的需求，赵宸阳还增设了一系列的参数选项。
- 这意味着用户可以依据自身需求定制工具功能，以满足各种监控目标。

#### 开发进展及挑战:

- 赵宸阳详述了在开发过程中所碰到的技术问题以及解决策略。
- 对于尚待解决的问题，他特别列出了潜在的解决方案和实施计划。
- 同时，他分享了在测试阶段观察到的一些有趣现象，如某些意外的网络行为。

#### 与赵晨宇的合作及取得的成果:

- 他们的交流非常深入，主要围绕学习协议栈的流程。
- 目前，他们正致力于研发新的协议栈优化技术，以期望进一步提升网络性能。
- 赵晨宇还分享了其在其他项目中的经验，这些建议对目前的开发工作大有裨益。

#### 团队建议与未来规划:

- 陈莉君和陈继峰均提供了宝贵的意见，他们建议在PPT展示中加入详细的工作流程图以增强说服力。
- 赵宸阳也分享了接下来的工作计划，包括完善工具的可视化界面、加强数据包的分析功能以及执行大规模的测试。
- 在会议结束时，团队进一步探讨了工具的市场推广策略，以确保其能广泛地为网络管理员所用。









## 基于EBPF的无侵入式服务请求流量判定与重定向——吴征阳

### 背景介绍：

- 当K8S集群规模扩大、pod数量增多时，对service的网络请求需要查表并进行中转，这会增加查表时间，并且与集群规模及pod规模存在关联。
- 请求在传输过程中可能需多次转发，导致增加跳数，进一步影响整体的吞吐量和访问速度。
- 通过EBPF，在内核层可以实现无侵入式的微服务功能，确保网络访问的高效性。

### 项目目标与预期能力：

- 拦截connect请求，直接判定所需的后端地址并转发，以减轻因集群规模增长导致的线性资源消耗。
- 实现并优化内核态的微服务功能，包括无侵入式的pod限流、pod降级、服务灰度等。

### 具体方案：

- 利用两个map (service map 和 backend map) 进行数据管理，同时支持基于K8S元数据的map更新。
- 后端pod的选择机制：可以随机或按权重进行选择。
- 跨service的后端选择，以及自动摘除指定故障节点pod的功能。

### 测试与效果：

- 在本地mini库集群进行测试，优化后的请求时间从189秒缩短至187.51秒，提速大约0.8%。
- 当后端pod数量较少时，优化效果可能不太明显，但在大规模的集群中，效果可能会更加显著。

### 项目进展与管理：

- 使用敏捷工具进行项目管理，列出功能设计及已完成但未合并的功能。
- 目前已完成约70%的开发工作。
- 下一步计划：实现灰度发布和蓝绿发布的能力。
- 已编写项目文档，内容包括设计理念、安装/运行步骤及未来发展方向。

## 微服务能力的后续任务：

- 吴征阳表示，后端微服务能力是后续工作的重点，这包括映射关系的设计与实现。
- 完成此功能后，将进一步实现微服务的其他功能，例如灰度测试和自动摘除功能。

### 任务测试与评估：

- 陈继峰强调了大数据环境下的大规模服务测试，并建议进行全方位性能对比。
- 吴征阳建议可以绘制火焰图进行性能对比。

### 任务管理与验收标准：

- 赵晨雨强调了任务的管理和验收方式，要求所有团队成员使用issue进行任务管理，确保PR格式标准化。
- 每一步的优化都已被量化，团队鼓励性能进一步提高，目标是从1.5%提升至1.8%或更高。

### 开源项目的重要性：

- 陈继峰指出，此项目不仅仅是参赛项目，更是一个开源项目。

### 其他建议：

- 陈莉君认为，团队其他成员应该学习并模仿吴征阳的工作方式和管理模式。
- 赵晨雨建议，下次会议后，所有成员都应按照此格式进行任务管理。









##  基于EBPF的调用栈统计工具——刘冰

- ### 背景及目标：

  - 旨在最小化工具对机器性能的损耗。
  - 探索合适的技术调用栈方式。
  - 虽然已完成异常检测和预分类，但数据的复杂性仍需深入处理。
  - 主要功能涉及CPU、Memory和IO。数据处理方法主要包括排序输出、火焰图的优化展示和JSON格式输出。

- ### 整体框架：

  - 采用EBPF和C++进行实现。
  - 通过统一接口和虚拟类确保结构的清晰性，并易于后续扩展。

- ### 各功能模块：

  - **CPU Module**：追踪在线进程的调用栈，以发现潜在的性能瓶颈。
  - **Load Monitor**：当系统负载超出预设值时，记录相关调用栈。
  - **Memory Module**：追踪用户态的内存分配，找出释放内存的路径并优化程序内存使用。
  - **IO Module**：跟踪至UFS层，以发现IO数据量异常的站点。

- ### 数据处理方式：

  - 包括数据排序、实时展示、数据持久化以及火焰图的展示。

- ### 演示：

  - 能够实时生成并展示火焰图。
  - 该工具配备了众多选项，如设定进程ID和选择不同模式。
  - 输出的数据是按降序排列的，每5秒更新一次。

- ### 结语：

  - 该工具仍处于开发阶段，后续会持续迭代和完善。

### 项目文档讨论

- #### 项目文档和用户手册：

  - 赵晨雨对用户手册和相关文档表示了关心。
  - 刘冰回应称手册正在完善中，计划在二月份细化输出和日志文件的格式描述。

- #### 关于Readme的建议：

  - 陈继峰提议参考其他开源项目的Readme格式，内容应从简介延伸至使用方法。

- #### 项目功能展望：

  - 赵晨雨询问了后续功能的添加，刘冰计划增添异常检测功能。
  - 双方讨论了火焰图中如何展示进程ID以及如何与内核数据关联的问题。

- #### 工具推荐：

  - 赵晨雨推荐了PlantUML工具，并强调UML图在项目文档中的关键作用。

### 结论与行动计划：

1. 刘冰需尽快完善用户手册，并计划在二月份更新文档描述。
2. 刘冰应考虑赵晨雨和陈继峰的意见，参照开源项目优化Readme，并深入探索项目功能的方向。
3. 在项目功能上，应重点关注如何将进程ID与内核数据进行关联。
4. 所有团队成员都应考虑使用PlantUML来提升文档的整体质量。









## 基于eBPF的Linux系统性能监测工具进行进程画像——张子恒

### 项目背景与目的：

- 本项目旨在基于eBPF的Linux系统性能监测工具上实现进程画像，特别是对用户态进程的画像。这一构想最初源于一个小型论文程序，旨在将其整合到某一开源项目中。
- 项目的核心概念为"进程画像"，旨在详细展现进程的全生命周期信息。

### 项目细节与设计：

#### 项目简介：

- 项目分为四部分：项目介绍、项目设计与实践、项目完成情况及自我总结。
- 主要目标是完成Linux进程全生命周期的画像，并增添可视化元素及交互功能。
- 项目在Ubuntu 22.04环境中运行，采用的内核版本为5.19。

#### 功能概述：

- 可监测操作系统中所有进程的CPU、内存使用率等信息。
- 实时跟踪指定进程在其生命周期内的CPU使用时间。
- 明确标出进程的上下文切换原因。
- 在进程画像中包含内核态和用户态的锁信息。
- 通过fork来实现子进程的画像。
- 实现新线程生命周期的监控。
- 将进程信息存储在map中，并能够设定采样频率，输出特定进程的资源使用情况。

### 项目实践与测试：

- 采用`top`命令进行信息查看。
- 利用`sleep`函数模拟进程中的CPU休眠，并使用eBPF程序进行追踪。
- 在测试程序中模拟进程异常、递归、加锁及解锁的场景。
- 成功捕捉到进程和线程的相关信息，并与预期结果一致。

### 项目进展与总结：

- 已经涵盖了所有的项目任务，但各个任务的完成度还有待加强。
- 已成功完成用户态的测试程序。
- 完成了学习文档的输出。
- 在开发过程中，加深了对Linux内核的理解，增强了内核编程能力，并掌握了其他相关技术。

### 未来计划与展望：

- 在当前的基础上进行更多的功能开发和持续优化。
- 将与项目导师保持密切沟通，确保项目任务的高效完成。

### 讨论重点：

1. 赵晨雨详细阐述了对项目未来的规划，并强调了整合各功能部分的重要性。
2. 陈继峰建议张子恒不应仅仅局限于比赛的需求，鼓励他提前完成和完善设计文档及PPT。









## 构建监控平台与其实现方案——桂香伟

### 项目背景：

- 传统的EBPF程序输出不直观，仅以log形式展现。
- 存在通过图形方式展现结果的需求。
- 经调查，Prometheus（普罗米修斯）和Grafana（古尔纳）能满足此需求。
- 与初期预期相比，目前的进展大致相符。

###  实现方案：

- 启动EBPF程序，初步处理数据后，每条记录形成一个字典。
- 数据存储到数据库，并加载到map中。
- 利用Prometheus的server定期收集数据并保存到实际数据库。
- 利用Grafana平台连接到server，快速实现数据的可视化。

### 数据问题及适配：

- 当前数据尚未完全准备好，数据提取过程中经常遇到障碍。
- 部分数据平台输出格式并不符合标准，需要进行适配。
- 原始数据需要解析并转化为适当形式。
- 通用平台需统一格式要求。满足此格式后，可通过一行命令实现数据收集与可视化。
- 对Prometheus进行适配，使用JSON格式进行数据重写与收集，通过Grafana的JSON API插件进行展示。

### 特殊数据适配：

- TCP Watch输出的信息繁多，但仅需部分数据。
- 不必要的数据部分被删减，仅保留关键记录。
- 对TCP Watch数据进行前置处理和裁剪，再加载到map中，通过Prometheus监控并用Grafana展示。

### 展示与使用：

- 通过视频展示了Grafana的展示效果及数据更新。
- 使用某命令加载网站，展示消息数据。
- 展示了测试期间和后期所产生的数据。
- 数据获取的时间间隔对数据准确性有所影响。

###  合作与资源共享：

- 陈阳和子恒提供了部分原始数据。
- 赵晨雨询问了这些数据的可视化情况。

###  项目标准与期望：

- 数据可视化是项目完成的关键标准。
- 数据的统一格式对于数据可视化至关重要。
- 若数据格式存在差异，需要进行适配。

###  未来计划：

- 计划搭建一个SQLite数据库存储系统，实现数据的持久化保存。
- 设计一键启动Grafana Pro的Docker容器功能。

###  迭代与改进：

- 数据格式需要多次迭代优化。









## 使用EBPF优化FUSE中的read方法性能——廉洋洋

### 项目概览：

- #### 内容概述：

  - **背景**：FUSE (文件用户空间系统) 是一个用户文件系统框架，允许用户实现自定义的文件系统。在多小文件读取场景下，如内存拷贝，存在性能瓶颈。
  - 设计思路：
    - 分析FUSE扩展模块的实现及其存在的瓶颈。
    - 深入探索EBPF中的look和read方法，对比原FUSE和本地文件系统的性能。
    - 修改Linux内核代码，借助EBPF技术来优化FUSE的read操作。
  - **实现**：基于标准的FUSE库，开发了一个简单的文件系统，并实现了文件/目录的基本操作，如创建、删除、修改和移动等。
  - **性能验证**：基于EBPF的测试文件系统进行验证，同时开发了性能测试工具FSR，并进行了测试验证。
  - **结果展示**：呈现了基于测试文件系统的挂载成功截图和性能测试工具FSR的运行结果。
  - **核心代码分析**：详细分析数据流程，具体函数的实现会在附录中展示。

### 项目实践中的挑战：

- **内核版本兼容性**：所用实现框架的内核版本与开源的版本存在差异，导致某些FUSE和扩展功能函数在资料中无法查到。
- **部分核心函数缺失**：在框架中，某些核心内核函数尚未实现。

### 陈继峰的提议及疑问：

- 提出了对增加的buffer数据大小是否有限制的疑问。
- 对项目的可行性提出了质疑。

### 廉洋洋的响应：

- 对于buffer的数据大小，目前还未做出最终决策。
- 坚信项目是切实可行的，并计划引入一种新的type类型，但其具体大小尚未决定。

### 赵晨雨的项目进度检查：

- 指出师兄的进度并未达到预期，并发现其在工作流程中跳过了某些关键的优化步骤，转向了开发和测试。赵晨雨强调，优化是此项目的核心，希望廉洋洋能够重新定位重心。

### 赵晨雨的策略建议：

- 建议集中注意力于当前的核心任务，而不是被其他外在因素干扰。强调了技能提升的重要性和与用户态的紧密结合。

### 团队协作及任务分配：

- 赵晨雨详述了工作任务如何被分配，并鼓励团队成员按照自己的目标来发挥最大潜能。并暗示团队在未来可能进行的合作项目，强调成员当前应专注于各自的任务。

### 评估与评价：

- 赵晨雨提到项目结束时会有一系列的评估标准，如PR数、代码量、编码规范等，这些指标将作为评价团队成员表现的依据。